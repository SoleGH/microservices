# MICROSERVICES

## 定义
微服务是一种**架构风格**，一个`大型复杂软件应用`由`一个或多个微服务`组成。系统中的`各个微服务`可被`独立部署`，各个`微服务之间`是`松耦合`的。每个微服务仅关注于完成一件任务并很好地完成该任务。在所有情况下，每个任务代表着一个小的业务能力。
将独立的功能模块封装成服务（微服务），完整的系统由一个或多个独立的服务组成
## 特点
* 微小度颗粒
* 责任单一性
* 运行隔离性
* 管理自动化
## 设计原则
* 通过服务实现应用的组件化：每个微服务（组件）可被独立替换和升级；    
* 围绕业务能力组织服务:围绕业务实现组织团队，根据业务需求，团队组织结构必须跨功能（如：应用，数据库）
* 产品而非项目模式：团队负责微服务完整周期，谁开发谁运营；
* 组件端点侧通讯，通讯机制或组件应该尽量简单及松耦合。（常用RESTful HTTP）
* “去中心化”治理：各组件不要求技术统一
* “去中心化”数据管理:倡导采用多样性持久化，不同微服务可采用不同持久化技术；
* 基础设施自动化(InfrastructureAutomation)：云化及自动化部署等技术极大地降低了微服务构建、部署和运维的难度，通过应用持续集成和持续交付等方法有助于达到加速推出市场的目的。
* 故障处理设计(Designfor failure)：微服务架构所带来的一个后果是必须考虑每个服务的失败容错机制。因此，微服务非常重视建立架构及业务相关指标的实时监控和日志机制。
* 演进式的设计(EvolutionaryDesign)：微服务应用更注重快速更新，因此系统的计会随时间不断变化及演进。微服务的设计受业务功能的生命周期等因素影响
### 优点
* 每个服务都比较简单，只关注于一个业务功能。
* 微服务架构方式是`松耦合`的，可以提供更高的`灵活性`。
* 微服务可通过**最佳**及**最合适**的`不同的编程语言与`工具进行开发，能够做到有的放矢地解决针对性问题。
* 每个微服务可由不同团队独立开发(`并行开发`)，互不影响，加快推出市场的速度。
* 微服务架构是持续交付(CD)的巨大推动力，**允许在频繁发布不同服务的同时保持系统其他部分的可用性和稳定性**。
### 缺点
* **运维开销及成本增加**：整体应用可能只需部署至一小片应用服务区集群，而微服务架构可能变成需要构建/测试/部署/运行数十个独立的服务，并可能需要支持多种语言和环境。这导致一个整体式系统如果由20个微服务组成，可能需要40~60个进程。
* **必须有坚实的DevOps开发运维一体化技能**：开发人员需要熟知运维与投产环境，开发人员也需要掌握必要的数据存储技术如NoSQL，具有较强DevOps技能的人员比较稀缺，会带来招聘人才方面的挑战。
* **隐式接口及接口匹配问题**：把系统分为多个协作组件后会产生新的接口，这意味着简单的交叉变化可能需要改变许多组件，并需协调一起发布。在实际环境中，一个新品发布可能被迫同时发布大量服务，由于集成点的大量增加，微服务架构会有更高的发布风险。
* **代码重复**：某些底层功能需要被多个服务所用，为了避免将“同步耦合引入到系统中”，有时需要向不同服务添加一些代码，这就会导致代码重复。
* **分布式系统的复杂性**：作为一种分布式系统，微服务引入了复杂性和其他若干问题，例如`网络延迟`、`容错性`、`消息序列化`、`不可靠的网络`、`异步机制`、`版本化`、`差异化的工作负载`等，开发人员需要考虑以上的分布式系统问题。
* **异步机制**：微服务往往使用异步编程、消息与并行机制，如果应用存在跨微服务的事务性处理，其实现机制会变得复杂化(`跨服务器数据同步`)。
* **可测性的挑战**：在动态环境下服务间的交互会产生非常微妙的行为，难以可视化及全面测试。经典微服务往往不太重视测试，更多的是通过监控发现生产环境的异常，进而快速回滚或采取其他必要的行动。但对于特别在意风险规避监管或投产环境错误会产生显著影响的场景下需要特别注意。
## 如何才能称为微服务：
* 根据业务模块划分服务种类；
* 每个服务可独立部署且相互隔离；
* 通过轻量级API调用服务；
* 服务需保证良好的高调用性；

## 总结
  微服务架构是根据具体业务将整个服务系统分割成多个微服务（组件），每个微服务为独立的服务器，可独立开发、部署运行;各微服务之间通过API实现数据交互；方便并行开发，单个微服务不影响其它微服务的运行，方便部分功能迭代开发。
  优点：
  在服务扩展方面：可只扩展比较占用资源的微服务，相对于传统的框架只能整体扩展反而会浪费部分资源有着明显优势；
  在团队开发方面：各服务独立，只通过API交互，只要定义好API规范，每个模块可用完全不同的技术实现；且可以独立部署；
  
  